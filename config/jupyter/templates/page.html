{% extends "page.html" %}

{% block site %}
<div id="donation-banner" role="banner" aria-label="Neurodesk donation request" style="position: fixed; top: 0; left: 0; right: 0; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 12px 20px; text-align: center; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif; font-size: 14px; z-index: 1100; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15); display: flex; align-items: center; justify-content: center; gap: 15px;">
    <span class="heart-icon" style="display: inline-block; animation: heartbeat 1.5s ease-in-out infinite;" aria-hidden="true">❤️</span>
    <span>
        Support Neurodesk! Help us maintain this free platform by 
        <a href="https://donations.uq.edu.au/EAINNEUR" target="_blank" rel="noopener noreferrer" style="color: white; font-weight: 600; text-decoration: underline;">donating to our infrastructure costs <span style="font-size: 0.85em;">(opens in new tab)</span></a>.
    </span>
    <button id="donation-banner-close" aria-label="Dismiss donation banner" style="background: rgba(255, 255, 255, 0.2); border: none; color: white; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; margin-left: 15px;">Dismiss</button>
</div>

<style>
@keyframes heartbeat {
    0%, 100% { transform: scale(1); }
    10%, 30% { transform: scale(1.1); }
    20%, 40% { transform: scale(1); }
}
#donation-banner ~ * {
    margin-top: 50px;
}
#donation-banner-close:hover {
    background: rgba(255, 255, 255, 0.3);
}
#donation-banner-close:focus {
    outline: 2px solid white;
    outline-offset: 2px;
}
</style>

<script>
(function() {
    'use strict';
    
    const banner = document.getElementById('donation-banner');
    if (!banner) return; // Exit if banner element doesn't exist
    
    // Check if banner was previously closed (with localStorage fallback)
    let bannerClosed = false;
    try {
        bannerClosed = localStorage.getItem('neurodeskDonationBannerClosed') === 'true';
    } catch (e) {
        // localStorage not available (e.g., private browsing mode)
        console.warn('localStorage not available for donation banner:', e);
    }
    
    if (bannerClosed) {
        banner.style.display = 'none';
    }
    
    // Add close functionality
    const closeButton = document.getElementById('donation-banner-close');
    if (closeButton) {
        closeButton.addEventListener('click', function() {
            banner.style.display = 'none';
            try {
                localStorage.setItem('neurodeskDonationBannerClosed', 'true');
            } catch (e) {
                // localStorage not available - banner will show again on reload
                console.warn('Could not save banner dismissal:', e);
            }
        });
    }
})();
</script>

{{ super() }}
{% endblock %}
